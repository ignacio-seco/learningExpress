let jsonArr = [
  {
    controleFinanceiro: { gastos: [], ganhos: [] },
    _id: "638aa5d8e56f87444ebcb65f",
    nome: "Boa Vida",
    pastos: ["Alegria", "Moriá", "Bom Retiro"],
    revTime: "2022-12-06T18:52:12.746Z",
    dataRevision: 0,
    backupVersion: 47,
    rebanho: [
      {
        dadosCompra: {
          comprado: false,
          dtCompra: "",
          valorCompra: 0,
          vendedor: "",
        },
        dadosMorte: { morreu: false, dtMorte: "", causaMorte: "" },
        dadosVenda: {
          vendida: true,
          valorVenda: 25000,
          comprador: "Kaioh",
          dtVenda: "2022-05-20",
        },
        uuid: "ec0458b7-6967-475d-9157-aea633845938",
        brinco: "",
        brincoDaMae: "",
        dadosCruzamentos: [],
        dtNascimento: "2022-11-05",
        dadosVacinas: [],
        estadaCurral: [],
        historico: [],
        imagem_url: "https://pngimg.com/uploads/cow/cow_PNG50576.png",
        noCurral: false,
        nome: "Goku",
        pasto: "",
        pesagem: [
          {
            peso: 80,
            dtPesagem: "2022-12-06",
            _id: "638f7a8e48b1883567633529",
            createdAt: "2022-12-06T18:52:12.747Z",
            updatedAt: "2022-12-06T18:52:12.747Z",
          },
        ],
        producaoLeite: [],
        sexo: "MACHO",
        _id: "638f5b1048b1883567632f0f",
        createdAt: "2022-12-06T18:52:12.747Z",
        updatedAt: "2022-12-06T18:52:12.747Z",
      },
      {
        dadosCompra: {
          comprado: false,
          dtCompra: "",
          valorCompra: 0,
          vendedor: "",
        },
        dadosMorte: { morreu: false, dtMorte: "", causaMorte: "" },
        dadosVenda: {
          vendida: false,
          valorVenda: 0,
          comprador: "",
          dtVenda: "",
        },
        uuid: "ec0458b7-6967-475d-9157-aea633845838",
        brinco: "",
        brincoDaMae: "",
        dadosCruzamentos: [],
        dtNascimento: "2022-10-05",
        dadosVacinas: [],
        estadaCurral: [],
        historico: [],
        imagem_url: "https://pngimg.com/uploads/cow/cow_PNG50576.png",
        noCurral: false,
        nome: "Gohan",
        pasto: "",
        pesagem: [
          {
            peso: 110,
            dtPesagem: "2022-12-06",
            _id: "638f7a9648b1883567633559",
            createdAt: "2022-12-06T18:52:12.747Z",
            updatedAt: "2022-12-06T18:52:12.747Z",
          },
        ],
        producaoLeite: [],
        sexo: "MACHO",
        _id: "638f5b1b48b1883567632f1f",
        createdAt: "2022-12-06T18:52:12.747Z",
        updatedAt: "2022-12-06T18:52:12.747Z",
      },
      {
        dadosCompra: {
          comprado: false,
          dtCompra: "",
          valorCompra: 0,
          vendedor: "",
        },
        dadosMorte: { morreu: false, dtMorte: "", causaMorte: "" },
        dadosVenda: {
          vendida: false,
          valorVenda: 0,
          comprador: "",
          dtVenda: "",
        },
        uuid: "55e37192-4ff6-4747-874c-f2b02665ed6f",
        brinco: "",
        brincoDaMae: "",
        dadosCruzamentos: [],
        dtNascimento: "2022-08-05",
        dadosVacinas: [],
        estadaCurral: [],
        historico: [],
        imagem_url: "https://pngimg.com/uploads/cow/cow_PNG50576.png",
        noCurral: false,
        nome: "Trunks",
        pasto: "",
        pesagem: [
          {
            peso: 140,
            dtPesagem: "2022-12-06",
            _id: "638f7a9a48b188356763358e",
            createdAt: "2022-12-06T18:52:12.747Z",
            updatedAt: "2022-12-06T18:52:12.747Z",
          },
        ],
        producaoLeite: [],
        sexo: "MACHO",
        _id: "638f60ce48b188356763306c",
        createdAt: "2022-12-06T18:52:12.747Z",
        updatedAt: "2022-12-06T18:52:12.747Z",
      },
      {
        dadosCompra: {
          comprado: false,
          dtCompra: "",
          valorCompra: 0,
          vendedor: "",
        },
        dadosMorte: { morreu: false, dtMorte: "", causaMorte: "" },
        dadosVenda: {
          vendida: false,
          valorVenda: 0,
          comprador: "",
          dtVenda: "",
        },
        uuid: "8e0e85ba-4d6d-454b-997f-5654a5515727",
        brinco: "",
        brincoDaMae: "",
        dadosCruzamentos: [],
        dtNascimento: "2022-04-05",
        dadosVacinas: [],
        estadaCurral: [],
        historico: [],
        imagem_url: "https://pngimg.com/uploads/cow/cow_PNG50576.png",
        noCurral: false,
        nome: "Vegeta",
        pasto: "",
        pesagem: [
          {
            peso: 157,
            dtPesagem: "2022-12-06",
            _id: "638f7a9f48b18835676335c8",
            createdAt: "2022-12-06T18:52:12.747Z",
            updatedAt: "2022-12-06T18:52:12.747Z",
          },
        ],
        producaoLeite: [],
        sexo: "MACHO",
        _id: "638f60e248b188356763309a",
        createdAt: "2022-12-06T18:52:12.747Z",
        updatedAt: "2022-12-06T18:52:12.747Z",
      },
      {
        dadosCompra: {
          comprado: false,
          dtCompra: "",
          valorCompra: 0,
          vendedor: "",
        },
        dadosMorte: { morreu: false, dtMorte: "", causaMorte: "" },
        dadosVenda: {
          vendida: false,
          valorVenda: 0,
          comprador: "",
          dtVenda: "",
        },
        uuid: "5d7dd59e-894c-48b2-b8f7-dd0aca744018",
        brinco: "",
        brincoDaMae: "",
        dadosCruzamentos: [],
        dtNascimento: "2020-06-05",
        dadosVacinas: [],
        estadaCurral: [
          {
            dtEntradaCurral: "2022-12-08",
            dtSaidaCurral: "",
            _id: "638f74c748b1883567633434",
            createdAt: "2022-12-06T18:52:12.747Z",
            updatedAt: "2022-12-06T18:52:12.747Z",
          },
        ],
        historico: [],
        imagem_url: "https://pngimg.com/uploads/cow/cow_PNG50576.png",
        noCurral: true,
        nome: "Bulma",
        pasto: "",
        pesagem: [
          {
            peso: 400,
            dtPesagem: "2022-12-06",
            _id: "638f7aa548b1883567633608",
            createdAt: "2022-12-06T18:52:12.747Z",
            updatedAt: "2022-12-06T18:52:12.747Z",
          },
        ],
        producaoLeite: [
          {
            qtdLitros: 21,
            dtVerificacao: "2022-12-06",
            _id: "638f752248b18835676334ad",
            createdAt: "2022-12-06T18:52:12.747Z",
            updatedAt: "2022-12-06T18:52:12.747Z",
          },
        ],
        sexo: "FEMEA",
        _id: "638f6fe748b1883567633129",
        createdAt: "2022-12-06T18:52:12.747Z",
        updatedAt: "2022-12-06T18:52:12.747Z",
      },
      {
        dadosCompra: {
          comprado: false,
          dtCompra: "",
          valorCompra: 0,
          vendedor: "",
        },
        dadosMorte: { morreu: false, dtMorte: "", causaMorte: "" },
        dadosVenda: {
          vendida: false,
          valorVenda: 0,
          comprador: "",
          dtVenda: "",
        },
        uuid: "c4c04f83-e278-40d7-886c-ec643745934c",
        brinco: "",
        brincoDaMae: "",
        dadosCruzamentos: [],
        dtNascimento: "2021-09-05",
        dadosVacinas: [],
        estadaCurral: [
          {
            dtEntradaCurral: "2022-11-22",
            dtSaidaCurral: "",
            _id: "638f838948b1883567633731",
            createdAt: "2022-12-06T18:52:12.747Z",
            updatedAt: "2022-12-06T18:52:12.747Z",
          },
        ],
        historico: [],
        imagem_url: "https://pngimg.com/uploads/cow/cow_PNG50576.png",
        noCurral: true,
        nome: "Chichi",
        pasto: "",
        pesagem: [
          {
            peso: 250,
            dtPesagem: "2022-12-06",
            _id: "638f849948b18835676338f9",
            createdAt: "2022-12-06T18:52:12.747Z",
            updatedAt: "2022-12-06T18:52:12.747Z",
          },
        ],
        producaoLeite: [
          {
            qtdLitros: 12,
            dtVerificacao: "2022-12-06",
            _id: "638f839848b18835676337e7",
            createdAt: "2022-12-06T18:52:12.747Z",
            updatedAt: "2022-12-06T18:52:12.747Z",
          },
        ],
        sexo: "FEMEA",
        _id: "638f837948b18835676336db",
        createdAt: "2022-12-06T18:52:12.747Z",
        updatedAt: "2022-12-06T18:52:12.747Z",
      },
      {
        dadosCompra: {
          comprado: false,
          dtCompra: "",
          valorCompra: 0,
          vendedor: "",
        },
        dadosMorte: { morreu: false, dtMorte: "", causaMorte: "" },
        dadosVenda: {
          vendida: false,
          valorVenda: 0,
          comprador: "",
          dtVenda: "",
        },
        uuid: "646e3459-5c6f-41a1-ad4d-8b373ad34d49",
        brinco: "",
        brincoDaMae: "",
        dadosCruzamentos: [],
        dtNascimento: "2022-09-05",
        dadosVacinas: [],
        estadaCurral: [],
        historico: [],
        imagem_url: "https://pngimg.com/uploads/cow/cow_PNG50576.png",
        noCurral: false,
        nome: "Goten",
        pasto: "",
        pesagem: [
          {
            peso: 90,
            dtPesagem: "2022-12-06",
            _id: "638f8eba48b1883567635271",
            createdAt: "2022-12-06T18:52:12.747Z",
            updatedAt: "2022-12-06T18:52:12.747Z",
          },
        ],
        producaoLeite: [],
        sexo: "MACHO",
        _id: "638f853648b18835676339ea",
        createdAt: "2022-12-06T18:52:12.747Z",
        updatedAt: "2022-12-06T18:52:12.747Z",
      },
      {
        dadosCompra: {
          comprado: false,
          dtCompra: "",
          valorCompra: 0,
          vendedor: "",
        },
        dadosMorte: { morreu: false, dtMorte: "", causaMorte: "" },
        dadosVenda: {
          vendida: false,
          valorVenda: 0,
          comprador: "",
          dtVenda: "",
        },
        uuid: "0e23fa1a-c8ff-4d09-86a7-010dac7d9c8c",
        brinco: "45",
        brincoDaMae: "",
        dadosCruzamentos: [],
        dtNascimento: "2021-12-05",
        dadosVacinas: [],
        estadaCurral: [],
        historico: [],
        imagem_url: "https://pngimg.com/uploads/cow/cow_PNG50576.png",
        noCurral: false,
        nome: "Kuririn",
        pasto: "",
        pesagem: [
          {
            peso: 290,
            dtPesagem: "2022-12-06",
            _id: "638f8ec948b18835676352fb",
            createdAt: "2022-12-06T18:52:12.747Z",
            updatedAt: "2022-12-06T18:52:12.747Z",
          },
        ],
        producaoLeite: [],
        sexo: "MACHO",
        _id: "638f85cb48b1883567633aa1",
        createdAt: "2022-12-06T18:52:12.747Z",
        updatedAt: "2022-12-06T18:52:12.747Z",
      },
      {
        dadosCompra: {
          comprado: false,
          dtCompra: "",
          valorCompra: 0,
          vendedor: "",
        },
        dadosMorte: { morreu: false, dtMorte: "", causaMorte: "" },
        dadosVenda: {
          vendida: false,
          valorVenda: 0,
          comprador: "",
          dtVenda: "",
        },
        uuid: "26de411c-eb82-48cb-881d-7c47f520a0fe",
        brinco: "78",
        brincoDaMae: "",
        dadosCruzamentos: [],
        dtNascimento: "2022-04-05",
        dadosVacinas: [],
        estadaCurral: [],
        historico: [],
        imagem_url: "https://pngimg.com/uploads/cow/cow_PNG50576.png",
        noCurral: false,
        nome: "Picolo",
        pasto: "",
        pesagem: [
          {
            peso: 150,
            dtPesagem: "2022-12-06",
            _id: "638f8eef48b188356763554f",
            createdAt: "2022-12-06T18:52:12.747Z",
            updatedAt: "2022-12-06T18:52:12.747Z",
          },
        ],
        producaoLeite: [],
        sexo: "MACHO",
        _id: "638f861748b1883567633b28",
        createdAt: "2022-12-06T18:52:12.747Z",
        updatedAt: "2022-12-06T18:52:12.747Z",
      },
      {
        dadosCompra: {
          comprado: false,
          dtCompra: "",
          valorCompra: 0,
          vendedor: "",
        },
        dadosMorte: { morreu: false, dtMorte: "", causaMorte: "" },
        dadosVenda: {
          vendida: false,
          valorVenda: 0,
          comprador: "",
          dtVenda: "",
        },
        uuid: "43cba9c3-878f-4d79-a7c0-02132904bac6",
        brinco: "18",
        brincoDaMae: "",
        dadosCruzamentos: [],
        dtNascimento: "2021-10-05",
        dadosVacinas: [],
        estadaCurral: [
          {
            dtEntradaCurral: "2022-12-01",
            dtSaidaCurral: "",
            _id: "638f8e7048b1883567634fc2",
            createdAt: "2022-12-06T18:52:12.747Z",
            updatedAt: "2022-12-06T18:52:12.747Z",
          },
        ],
        historico: [],
        imagem_url: "https://pngimg.com/uploads/cow/cow_PNG50576.png",
        noCurral: true,
        nome: "Androide",
        pasto: "",
        pesagem: [
          {
            peso: 250,
            dtPesagem: "2022-09-08",
            _id: "638f8f5c48b188356763582b",
            createdAt: "2022-12-06T18:52:12.747Z",
            updatedAt: "2022-12-06T18:52:12.747Z",
          },
          {
            peso: 260,
            dtPesagem: "2022-10-19",
            _id: "638f8f5c48b188356763582c",
            createdAt: "2022-12-06T18:52:12.747Z",
            updatedAt: "2022-12-06T18:52:12.747Z",
          },
          {
            peso: 280,
            dtPesagem: "2022-12-06",
            _id: "638f8f5c48b188356763582d",
            createdAt: "2022-12-06T18:52:12.747Z",
            updatedAt: "2022-12-06T18:52:12.747Z",
          },
        ],
        producaoLeite: [
          {
            qtdLitros: 14,
            dtVerificacao: "2022-12-06",
            _id: "638f8e9e48b1883567635122",
            createdAt: "2022-12-06T18:52:12.747Z",
            updatedAt: "2022-12-06T18:52:12.747Z",
          },
        ],
        sexo: "FEMEA",
        _id: "638f86be48b1883567633bde",
        createdAt: "2022-12-06T18:52:12.747Z",
        updatedAt: "2022-12-06T18:52:12.747Z",
      },
      {
        dadosCompra: {
          comprado: false,
          dtCompra: "",
          valorCompra: 0,
          vendedor: "",
        },
        dadosMorte: { morreu: false, dtMorte: "", causaMorte: "" },
        dadosVenda: {
          vendida: false,
          valorVenda: 0,
          comprador: "",
          dtVenda: "",
        },
        uuid: "240e93ca-8fe0-4400-aa99-35b05803f545",
        brinco: "99",
        brincoDaMae: "",
        dadosCruzamentos: [],
        dtNascimento: "2022-03-05",
        dadosVacinas: [],
        estadaCurral: [],
        historico: [],
        imagem_url: "https://pngimg.com/uploads/cow/cow_PNG50576.png",
        noCurral: false,
        nome: "Tenshinhan",
        pasto: "",
        pesagem: [
          {
            peso: 160,
            dtPesagem: "2022-12-06",
            _id: "638f8ef448b18835676355f6",
            createdAt: "2022-12-06T18:52:12.747Z",
            updatedAt: "2022-12-06T18:52:12.747Z",
          },
        ],
        producaoLeite: [],
        sexo: "MACHO",
        _id: "638f872448b1883567634747",
        createdAt: "2022-12-06T18:52:12.747Z",
        updatedAt: "2022-12-06T18:52:12.747Z",
      },
      {
        dadosCompra: {
          comprado: false,
          dtCompra: "",
          valorCompra: 0,
          vendedor: "",
        },
        dadosMorte: { morreu: false, dtMorte: "", causaMorte: "" },
        dadosVenda: {
          vendida: false,
          valorVenda: 0,
          comprador: "",
          dtVenda: "",
        },
        uuid: "c4873a93-eebd-43f9-a078-a2397e33fbf3",
        brinco: "65",
        brincoDaMae: "",
        dadosCruzamentos: [],
        dtNascimento: "2021-08-05",
        dadosVacinas: [],
        estadaCurral: [],
        historico: [],
        imagem_url: "https://pngimg.com/uploads/cow/cow_PNG50576.png",
        noCurral: false,
        nome: "Videl",
        pasto: "",
        pesagem: [
          {
            peso: 251,
            dtPesagem: "2022-12-06",
            _id: "638f8eea48b18835676354b9",
            createdAt: "2022-12-06T18:52:12.747Z",
            updatedAt: "2022-12-06T18:52:12.747Z",
          },
        ],
        producaoLeite: [],
        sexo: "FEMEA",
        _id: "638f896b48b1883567634ab9",
        createdAt: "2022-12-06T18:52:12.747Z",
        updatedAt: "2022-12-06T18:52:12.747Z",
      },
      {
        dadosCompra: {
          comprado: false,
          dtCompra: "",
          valorCompra: 0,
          vendedor: "",
        },
        dadosMorte: { morreu: false, dtMorte: "", causaMorte: "" },
        dadosVenda: {
          vendida: false,
          valorVenda: null,
          comprador: "",
          dtVenda: "",
        },
        uuid: "87ac3aee-c304-496f-b337-25ad94cf68d3",
        brinco: "",
        brincoDaMae: "",
        dadosCruzamentos: [],
        dtNascimento: "2018-10-05",
        dadosVacinas: [],
        estadaCurral: [],
        historico: [],
        imagem_url: "https://pngimg.com/uploads/cow/cow_PNG50576.png",
        noCurral: false,
        nome: "Oolong",
        pasto: "",
        pesagem: [
          {
            peso: 650,
            dtPesagem: "2022-12-06",
            _id: "638f8ed348b1883567635390",
            createdAt: "2022-12-06T18:52:12.747Z",
            updatedAt: "2022-12-06T18:52:12.747Z",
          },
        ],
        producaoLeite: [],
        sexo: "MACHO",
        _id: "638f8a0548b1883567634bb8",
        createdAt: "2022-12-06T18:52:12.747Z",
        updatedAt: "2022-12-06T18:52:12.747Z",
      },
    ],
    tarefas: [],
    createdAt: "2022-12-06T15:08:06.278Z",
    updatedAt: "2022-12-06T18:52:12.747Z",
    __v: 47,
  },
];
function deepSort(conjunto, key) {
  function isAnObject(testedObject) {
    if (
      typeof testedObject === "object" &&
      !Array.isArray(testedObject) &&
      testedObject !== null
    ) {
      return true;
    } else {
      return false;
    }
  }

  let result = {};
  let tTest = conjunto;
  let arr = [0];
  let i = 0;
  let t;
  let lTest;
  let tType;
  let foundKey;
  let fkTest;
  if (isAnObject(tTest)) {
    lTest = Object.keys(tTest);
  } else {
    lTest = tTest;
  } //observe que isso faz com que lTest seja sempre uma array...

  for (; arr.length > 0; ) {
    //console.log(arr)
    for (; arr[i] < lTest.length; ) {
      if (isAnObject(tTest)) {
        tType = tTest[lTest[arr[i]]];
      } else {
        tType = tTest[arr[i]];
      }
      console.log(
        `This array represent the coordinates that the for loop is looking at [ ${arr} ]`
      ); //O último valor representa a posição que está sendo analisada, enquanto os valores anteriores o caminho que está sendo percorrido até esta posição.
      if (isAnObject(tType)) {
        //aqui começa a formula quando o valor analizado em tTest[arr[i]] é um objeto e poderia ter a key procurada, passos, necessários 1- se tiver a key, fazer o cadastro e procurar no próximo nivel de arr[i], se não tiver a chave, fazer com que i suba de nível e procurar por objetos dentro de objetos ou arrays.
        if (key in tType) {
          foundKey = tType[key];
          //situação em que a chave foi encontrada no objeto
          if (isAnObject(foundKey)) {
            //situação em que a chave é uma array de valores
            fkTest = Object.keys(foundKey);
            if (fkTest.length > 0) {
              for (t = 0; t < fkTest.length; t++) {
                if (!(foundKey[fkTest[t]] in result)) {
                  //aqui testamos se já existe uma key com o nome do valor da chave encontrada. Se tiver o objeto é cadastrado nesse array, se não tiver é criada a chave como o array e o objeto é colocado nela. No primeiro if a chave não existe e precisa ser criada
                  result[foundKey[fkTest[t]]] = [];
                  result[foundKey[fkTest[t]]].push(tType);
                } // situação em que a chave já existia no conjunto result
                else {
                  result[foundKey[fkTest[t]]].push(tType);
                }
              }
              {
                if (Object.keys(tType).length > 0) {
                  // é necessário garantir que não estamos olhando um objeto vazio porque se atualizarmos a profundidade da arvore com objeto vazio a função retornará um erro ao não conseguir ler a propriedade do objeto que não existe.
                  i = i + 1;
                  arr[i] = 0;
                  tTest = tType;
                  lTest = Object.keys(tTest);
                } else {
                  arr[i] = arr[i] + 1;
                }
              }
            } else {
              //situação em que a chave encontrada é uma array vazia
              if (!(`empty` in result)) {
                //aqui testamos se já existe uma key com o nome do valor da chave encontrada. Se tiver o objeto é cadastrado nesse array, se não tiver é criada a chave como o array e o objeto é colocado nela. No primeiro if a chave não existe e precisa ser criada
                result[`empty`] = [];
                result[`empty`].push(tType);
                if (Object.keys(tType).length > 0) {
                  // é necessário garantir que não estamos olhando um objeto vazio porque se atualizarmos a profundidade da arvore com objeto vazio a função retornará um erro ao não conseguir ler a propriedade do objeto que não existe.
                  i = i + 1;
                  arr[i] = 0;
                  tTest = tType;
                  lTest = Object.keys(tTest);
                } else {
                  arr[i] = arr[i] + 1;
                }
              } // situação em que a chave já existia no conjunto result
              else {
                result[`empty`].push(tType);
                if (Object.keys(tType).length > 0) {
                  // é necessário garantir que não estamos olhando um objeto vazio porque se atualizarmos a profundidade da arvore com objeto vazio a função retornará um erro ao não conseguir ler a propriedade do objeto que não existe.
                  i = i + 1;
                  arr[i] = 0;
                  tTest = tType;
                  lTest = Object.keys(tTest);
                } else {
                  arr[i] = arr[i] + 1;
                }
              }
            }
          } else if (Array.isArray(foundKey)) {
            //situação em que a chave é uma array de valores
            if (foundKey.length > 0) {
              for (t = 0; t < foundKey.length; t++) {
                if (!(foundKey[t] in result)) {
                  //aqui testamos se já existe uma key com o nome do valor da chave encontrada. Se tiver o objeto é cadastrado nesse array, se não tiver é criada a chave como o array e o objeto é colocado nela. No primeiro if a chave não existe e precisa ser criada
                  result[foundKey[t]] = [];
                  result[foundKey[t]].push(tType);
                } // situação em que a chave já existia no conjunto result
                else {
                  result[foundKey[t]].push(tType);
                }
              }
              {
                if (Object.keys(tType).length > 0) {
                  // é necessário garantir que não estamos olhando um objeto vazio porque se atualizarmos a profundidade da arvore com objeto vazio a função retornará um erro ao não conseguir ler a propriedade do objeto que não existe.
                  i = i + 1;
                  arr[i] = 0;
                  tTest = tType;
                  lTest = Object.keys(tTest);
                } else {
                  arr[i] = arr[i] + 1;
                }
              }
            } else {
              //situação em que a chave encontrada é uma array vazia
              if (!(`empty` in result)) {
                //aqui testamos se já existe uma key com o nome do valor da chave encontrada. Se tiver o objeto é cadastrado nesse array, se não tiver é criada a chave como o array e o objeto é colocado nela. No primeiro if a chave não existe e precisa ser criada
                result[`empty`] = [];
                result[`empty`].push(tType);
                if (Object.keys(tType).length > 0) {
                  // é necessário garantir que não estamos olhando um objeto vazio porque se atualizarmos a profundidade da arvore com objeto vazio a função retornará um erro ao não conseguir ler a propriedade do objeto que não existe.
                  i = i + 1;
                  arr[i] = 0;
                  tTest = tType;
                  lTest = Object.keys(tTest);
                } else {
                  arr[i] = arr[i] + 1;
                }
              } // situação em que a chave já existia no conjunto result
              else {
                result[`empty`].push(tType);
                if (Object.keys(tType).length > 0) {
                  // é necessário garantir que não estamos olhando um objeto vazio porque se atualizarmos a profundidade da arvore com objeto vazio a função retornará um erro ao não conseguir ler a propriedade do objeto que não existe.
                  i = i + 1;
                  arr[i] = 0;
                  tTest = tType;
                  lTest = Object.keys(tTest);
                } else {
                  arr[i] = arr[i] + 1;
                }
              }
            }
          } else {
            //situação em que a chave encontrada é um valor
            if (!(foundKey in result)) {
              //aqui testamos se já existe uma key com o nome do valor da chave encontrada. Se tiver o objeto é cadastrado nesse array, se não tiver é criada a chave como o array e o objeto é colocado nela. No primeiro if a chave não existe e precisa ser criada
              result[foundKey] = [];
              result[foundKey].push(tType);
              if (Object.keys(tType).length > 0) {
                // é necessário garantir que não estamos olhando um objeto vazio porque se atualizarmos a profundidade da arvore com objeto vazio a função retornará um erro ao não conseguir ler a propriedade do objeto que não existe.
                i = i + 1;
                arr[i] = 0;
                tTest = tType;
                lTest = Object.keys(tTest);
              } else {
                arr[i] = arr[i] + 1;
              }
            } // situação em que a chave já existia no conjunto result
            else {
              result[foundKey].push(tType);
              if (Object.keys(tType).length > 0) {
                // é necessário garantir que não estamos olhando um objeto vazio porque se atualizarmos a profundidade da arvore com objeto vazio a função retornará um erro ao não conseguir ler a propriedade do objeto que não existe.
                i = i + 1;
                arr[i] = 0;
                tTest = tType;
                lTest = Object.keys(tTest);
              } else {
                arr[i] = arr[i] + 1;
              }
            }
          }
        } //aqui encerra a situação em que a chave foi encontrada.
        else {
          //situação em que a chave não foi encontrada no objeto
          if (Object.keys(tType).length > 0) {
            // é necessário garantir que não estamos olhando um objeto vazio porque se atualizarmos a profundidade da arvore com objeto vazio a função retornará um erro ao não conseguir ler a propriedade do objeto que não existe.
            i = i + 1;
            arr[i] = 0;
            tTest = tType;
            lTest = Object.keys(tTest);
          } else {
            arr[i] = arr[i] + 1;
          }
        }
      } else if (Array.isArray(tType)) {
        //aqui começa as ações se o item que está sendo analisado é uma array, e não pode ter a chave: passos, apenas subir um nível em arr[i] e atualizar o ltest para que represente o novo tamanho do novo nível do arr[i]
        if (tType.length > 0) {
          i = i + 1;
          arr[i] = 0;
          tTest = tType;
          lTest = tTest;
        } else {
          arr[i] = arr[i] + 1;
        }
      } else {
        arr[i] = arr[i] + 1; //nesse caso o item é um valor e o loop deve apenas continuar sem atualizar o lTest
      }
    }
    {
      //aqui é a ação a ser tomada quando o o valor de arr[i] ultrapassar o valor de length da array ltest. É melhor cadastrar a regra para conter o loop do primeiro for aqui uma vez que, aqui, é possível utilizar regras if enquanto no loop for não é...
      if (arr.length > 1) {
        console.log(`This is the array before the pop() comand [${arr}]`);
        i = i - 1; //isso retrocede a profundidade paara o nível anterior
        arr[i] = arr[i] + 1; //isso faz com que o loop não olhe o mesmo item novamente e siga em frente com a checagem
        arr.pop(); ///isso diminui o valor de arr.length e é necessário para o primeiro loop não ser eterno.
        console.log(`This is the new array after the pop() comand [${arr}]`);
        //nessa etapa é necessário reconstruir o tTest e o lTest para que eles estejam em conformidade com os valores que serão analisados, para isso usamos as coordenadas que já existem na array arr. O problema é que é necessário checar, para cada valor desse, se o que está ali é um objeto ou um array e no caso de objeto cadastrar a key no tTest e não o valor como fazemos com uma array. Ao final, atualizar o valor ltest para garantir que seja tratado como uma array ainda que o tTest final seja um objeto.
        tTest = conjunto;
        for (let y = 0; y < arr.length - 1; y++) {
          if (isAnObject(tTest)) {
            tTest = tTest[Object.keys(tTest)[arr[y]]];
          } else {
            tTest = tTest[arr[y]];
          }
        }
        {
          if (isAnObject(tTest)) {
            lTest = Object.keys(tTest);
          } else {
            lTest = tTest;
          }
        }
        //aqui comecei a inserir a checagem de undefined
      } //aqui se encerra o if
      else {
        arr.pop();
        ///nessa situação a formula se caminha para a derradeira conclusão.
      }
    }
  }
  {
    //resultado quando toda formula encerra
    return result;
  }
}

let updateArray = deepSort(jsonArr, "_id");
let itensToUpdate = Object.keys(updateArray);
console.log(updateArray);

function setToMongoFormat(updateObject, idkey) {
  function isAnObject(testedObject) {
    if (
      typeof testedObject === "object" &&
      !Array.isArray(testedObject) &&
      testedObject !== null
    ) {
      return true;
    } else {
      return false;
    }
  }
  let itensToUpdate = { ...updateObject };
  let idArray = Object.keys(itensToUpdate);
  idArray.forEach((id) => {
    let document = itensToUpdate[id][0];
    let keys = Object.keys(document);
    keys.forEach((key) => {
      if (Array.isArray(document[key])) {
        let newArray = [];
        let arrayOfitens = document[key];
        arrayOfitens.forEach((element) => {
          if (isAnObject(element) && idkey in element) {
            newArray.push(element[idkey]);
          } else {
            newArray.push(element);
          }
        });
        document[key] = newArray;
      }
    });
  });
  return itensToUpdate;
}
let dataToPass = setToMongoFormat(updateArray, "_id");
console.log(Object.keys(dataToPass));
//console.log(dataToPass["638f86be48b1883567633bde"][0]["producaoLeite"]);
//console.log(dataToPass["638aa5d8e56f87444ebcb65f"][0]["pastos"])
//console.log(dataToPass["638aa5d8e56f87444ebcb65f"][0]["rebanho"])
//console.log(dataToPass["638f8e9e48b1883567635122"])
